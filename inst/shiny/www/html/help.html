<h1 id="top"> </h1>
<img src="img/logo.png", height="70"> 
<br> 
<font color="#6C6CC4" size="3"> [statistical exploration of landscapes of phylogenetic trees]  </font>
<br>
<br>
<!-- <h1> Welcome to the <font color="#6C6CC4"> <i>treescape</i> </font> server! </h1> -->
<font color="#6C6CC4"> <i>treescape</i> </font> implements statistical tools for the exploration of
sets of phylogenetic trees describing the evolutionary relationships between the same taxa.
This web interface provides an easy access to the resources implemented in the package.

Each tab is made of two panels: a <i>sidebar</i> used to choose inputs, analysis tools and aesthetics, 
and a main panel displaying results.

<br>
<br>
 <h3 id="io"> <font color="#6C6CC4"> Tree landscape explorer </font></h3>
The <i>Tree landscape explorer</i> tab is where the whole tree space can be explored. 
Choose between a two- or three-dimensional plot to visualise the trees using Metric Multidimensional Scaling (MDS, a.k.a. Principal Coordinates Analysis, PCoA),
which calculates the best reduced-spaced visualisation of the distances between trees.

The <i>sidebar</i> contains the following sections:
 <ul>
  <li><font color="#6C6CC4"><a href="#io">Input</a></font>: to upload the set of trees to analyse </li>
  <li><font color="#6C6CC4"><a href="#analysis">Analysis</a></font>: to customize the analysis </li>
  <li><font color="#6C6CC4"><a href="#aesthetics">Aesthetics</a></font>: to customize the graphics </li>
</ul>

 <h4 id="io"> <font color="#6C6CC4"> Input </font></h4>
 <font color="#6C6CC4"> <i>treescape</i> </font> takes a list of phylogenetic trees as input. 
The user can choose between data distributed with the package, or provide input files.
Two types of input files can be used:
 <ul>
  <li>R objects saved using the function <font face="Courier New">save(x, file="x.RData")</font>
  where <font face="Courier New">'x'</font> is a list of trees of the class <font face="Courier
  New">multiphylo</font> (from the <i>ape</i> package. Accepted extensions are ".RData" and ".rda".</li>
  <li>list of trees saved in a nexus file, e.g. using <i>ape</i>'s function <font face="Courier
  New">write.nexus(x, file="x.nex")</font> in R.</li>
</ul>

 <h4 id="analysis"> <font color="#6C6CC4"> Analysis </font></h4>

 <b><font color="#6C6CC4">  Metric: </font></b>
 the metric to be used to measure distances between tips of the trees. Choose from:
<ul>
  <li> <i>Kendall Colijn metric</i>: the tree metric developed by Kendall & Colijn; used by default</li>
  <li> <i>patristic</i>: the sum of branch lengths on the shortest path between pairs of tips 
    (see <font face="Courier New">?distTips</font> in the package <i>adephylo</i>)</li>
  <li> <i>Number of nodes</i>: the total number of internal nodes on the shortest path between pairs of tips 
    (see <font face="Courier New">?distTips</font> in the package <i>adephylo</i>)</li>
  <li> <i>Abouheif</i>: the Abouheif metric
    (see <font face="Courier New">?distTips</font> in the package <i>adephylo</i>)</li>
  <li> <i>Sum of direct descendents</i>: another metric related to the Abouheif metric
    (see <font face="Courier New">?distTips</font> in the package <i>adephylo</i>)</li>
</ul>

 <b><font color="#6C6CC4">  Lambda: </font></b>
 The value of lambda used in Kendall & Colijn's metric.

 <b><font color="#6C6CC4">  Number of MDS axes retained : </font></b>
 The number of principal components to retain in the Metric Multidimensional Scaling (MDS). 

 <b><font color="#6C6CC4">  Identify clusters? </font></b>
 Whether to find clusters using the <font face="Courier New"> findGroves </font> function.
 When this option is selected, you will also have the option to choose the clustering method and number of clusters.

<br>
 <h4 id="aesthetics"> <font color="#6C6CC4"> Aesthetics </font></h4>
A number of graphical options are available. 

 <b><font color="#6C6CC4">  View </font></b>
 The default is to view the entire "tree landscape", that is, a 2- or 3-dimensional map where the points correspond to trees 
 and the distances between points approximate their relative distances in tree space, according to the chosen measure.
 The rest of the options detailed below correspond to this view.
 
 An alternative is to pick a single "reference tree" and plot the distances from it to each other tree.
 If this view is chosen, you will be given the option to select the reference tree of interest.
 When there are many trees in the set, it may be helpful to expand the plot by using the scale bar to increase the height,
 to view the tree labels more easily.
 Finally, if clusters are identified in the analysis then these will be marked on this plot in the corresponding colours.
 Note that this gives an indication of the quality of the clustering: highly scattered clusters correspond to poor resolution in the space.
 Clusters can overlap in this view: it is quite possible for multiple clusters of trees to be equidistant from the reference tree
 in different "directions" in the space.

 <b><font color="#6C6CC4">  View in 3D? </font></b>
 If three or more axes have been retained, the option to view the space in three dimensions will be available.
 It is possible to rotate the image by clicking on it and dragging the mouse, and to zoom in and out with the mouse scroll button.
 Note that 3D plotting depends on the <i> shinyRGL </i> package, which (currently) is <b> not supported </b> on the latest versions
 of the package <i> rgl </i>.
 If no image or a spurious message about enabling javascript appears, we recommend removing the current installation of <i> rgl </i>
 from your library and then installing the patch: 
 <font face="Courier New"> devtools::install_github('trestletech/rgl@js-class') </font>.
 For more details and to track progress on this issue, see 
 <a href="https://github.com/trestletech/shinyRGL" target="_blank">shinyRGL on GitHub</a>.

 <b><font color="#6C6CC4"> x/y/z axes: </font></b>
 Used to select which principal components are represented as x and y axes 
(and, if viewing in 3D, the z axis) on the scatterplot.

<br>
 <h4 id="output"> <font color="#6C6CC4"> Output </font></h4>
Beneath the scatterplot are output options: the scatterplot, trees and analysis results can be exported in various formats.
Currently available options are:
<ul>
  <li> save the 2D scatterplot as a .png file. Unfortunately a formal method to save the 3D plot is not 
  yet supported, but you can right-click (Mac: long-click) on the image and select '<i>Save image as ...</i>'. </li>
  <li> save trees to a Nexus file (.nex) </li>
  <li> save results as .csv file (spreadsheet-like text file; compatible with most systems);
  results are output as a table where each row is a tree label, and columns contain optional
  clustering results as well as principal components (PC) of the Metric Multidimensional Scaling
  (MDS) of the tree space </li>
  <li> save results as an R object (.RData); in this case, two objects will be saved in the
  .RData: 'trees' will be a list of trees of class 'multiPhylo', and 'analysis' will be the results
  of the analysis; when clusters are not inferred, 'analysis' is the output of the function
  'treescape'; when clusters are inferred, 'analysis' is the output of the function 'findGroves'.  </li>
</ul>

<br>
<br>
 <h3 id="io"> <font color="#6C6CC4"> Tree viewer </font></h3>
The <i>Tree viewer</i> tab is where individual trees can be examined.
The <i>sidebar</i> contains the following sections:
 <ul>
  <li><font color="#6C6CC4"><a href="#io">Input</a></font>: to pick the tree to view </li>
  <li><font color="#6C6CC4"><a href="#aesthetics">Aesthetics</a></font>: to customize the graphics </li>
</ul>

 <h4 id="io"> <font color="#6C6CC4"> Input </font></h4>
The tree selection options are as follows:
 <ul>
  <li>Median tree: select the overall median tree, or, if clusters have been identified, the median from each cluster</li>
  <li>General tree selection: select an individual tree by its name (if provided) or number in the list of trees supplied</li>
</ul>

 <h4 id="aesthetics"> <font color="#6C6CC4"> Aesthetics </font></h4>
A number of graphical options are available. 
See <font face="Courier New">?plot.phylo</font> from the package <i>ape</i> for more details.

<br>
 <h4 id="output"> <font color="#6C6CC4"> Output </font></h4>
Beneath the tree is the option to save the image as a .png file.

<br>
<br>
 <h3 id="io"> <font color="#6C6CC4"> densiTree viewer </font></h3>
The <i>densiTree viewer</i> tab is where collections of trees can be viewed together using the 
<font face="Courier New">densiTree</font> function from the package <i>phangorn</i>, which is based on the
software <a href="https://www.cs.auckland.ac.nz/~remco/DensiTree/" target="_blank">densiTree</a>, which provides
considerably more functionality.

The <i>sidebar</i> contains the following sections:
 <ul>
  <li><font color="#6C6CC4"><a href="#io">Input</a></font>: to pick the collection of trees to view </li>
  <li><font color="#6C6CC4"><a href="#aesthetics">Aesthetics</a></font>: to customize the graphics </li>
</ul>

 <h4 id="io"> <font color="#6C6CC4"> Input </font></h4>
The entire tree set can be viewed using the option 'All trees'. Note that this is likely to be slow for large sets of trees.
If clusters have been detected in the <i>Tree landscape explorer</i> tab then the collection of trees from each cluster can also be selected.
This can help to show the variation within the cluster.

<br>
 <h4 id="aesthetics"> <font color="#6C6CC4"> Aesthetics </font></h4>
 A number of graphical options are available; further options will be added soon.

<br>
 <h4 id="output"> <font color="#6C6CC4"> Output </font></h4>
Beneath the densiTree plot is the option to save the image as a .png file. 

<br>
<br>
  <h3 id="more"> <font color="#6C6CC4"> More information </font></h3>
 <i>treescape</i> is developed on <a href="https://github.com/thibautjombart/treescape" target="_blank">github</a>.
For questions, bug reports, feature requests and contributions, please
 use <a href="https://github.com/thibautjombart/treescape/issues" target="_blank">github's issue system</a>.

<br>
<br>
<br>
<a href="#top">[Back to top]</a>
<br>
<br>
<br>
